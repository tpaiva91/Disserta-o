\chapter{Fundamentos e Terminologia}\label{chap:concepts}

Este capítulo tem o propósito de explicar, com mais detalhe, conceitos que possam ser relevantes para um melhor entendimento da dissertação e vai ser dividido em duas partes: 1) definição da diabetes e alguns conceitos relacionados e 2) definição de \textit{data mining} e alguns conceitos relacionados. 
Assim sendo, vamos começar por explicar o é a diabetes, bem como alguns termos associados à doença que possam ser relevantes. Vamos também abordar de forma mais detalhada como pode ser feito o tratamento da doença e quais as ferramentas já existentes que possam auxiliar o mesmo. 
Tendo uma noção de como funciona, interessa descobrir como é que a informática pode ter algum relevo no tratamento. Para isso vai ser explicado o conceito de \textit{data mining} e alguns conceitos associados a esta área que possam ter algum relevo. Vão ser discutidas diferentes técnicas de \textit{data mining} que poderão ser usadas para diferentes coisas.

\section{\textit{Diabetes Mellitus}}

A diabetes é uma doença que se caracteriza por provocar elevados níveis de glicose (açúcar) no sangue nos seus portadores. A glicose é um dos tipos de hidratos de carbono, que são nutrientes presentes na comida. De forma sucinta, a glicose produz energia que vai ser utilizada pelas células, sendo por isso um dos hidratos de carbono mais importantes. 

Numa pessoa sem diabetes, a glicose é regulada através de uma hormona, a insulina, que vai ser libertada pelo pâncreas quando necessário. Depois de cada refeição, a insulina libertada vai ajudar o corpo a usar ou a guardar a glicose. 
Numa pessoa com diabetes isto não acontece: a glicose em excesso não vai ser usada e portanto a sua concentração no sangue vai aumentar para níveis prejudiciais. Há diferentes razões para que isto aconteça, sendo que todas elas provocam diabetes, embora de tipos diferentes. Os tipos mais comuns de diabetes são:

\begin{itemize}
\item \textit{\textbf{Diabetes Mellitus Tipo 1}} - 
Este tipo de diabetes também é conhecido como diabetes insulino-dependente ou diabetes juvenil, por normalmente aparecer em jovens e representa entre 5\% a 10 \% de todos os casos de diabetes.\cite{epidem}
Neste tipo de diabetes, o pâncreas deixa de produzir insulina pelo que os pacientes têm que tomar doses de insulina diariamente para conseguir regular a glicose.

\item \textit{\textbf{Diabetes Mellitus Tipo 2}} - 
Este tipo de diabetes também é conhecido por diabetes nao-insulino-dependente e representa cerca de 90\% de todos os casos de diabetes.~\cite{type2} Normalmente está associado a um estilo de vida pouco saudável e por isso mesmo, é frequentemente resultado de excesso de peso ou falta de exercício físico. 
Neste tipo de diabetes o pâncreas continua a produzir insulina mas o corpo não a consegue utilizar de forma adequada.  É comum os diabéticos de tipo 2 não necessitarem de insulina, apesar de haver também diabéticos tipo 2 insulino-dependentes, e a medicação é feita através de comprimidos. Apesar de a diabetes tipo 2 surgir normalmente em pessoas mais velhas, tem-se vindo a manifestar também em jovens.

\item {\textbf{Diabetes gestacional}} - 
Este tipo de diabetes pode aparecer durante a gravidez. Caracteriza-se por ter valores de glicose superiores aos normais mas, ainda assim, abaixo dos valores diagnosticados na diabetes.
É normalmente descoberto nas consultas de rotina e não por causa dos sintomas. Há também o risco de mulheres que sofram deste tipo de diabetes desenvolverem, no futuro, diabetes do tipo 2.

\item {\textbf{Diabetes LADA}} - 
O nome tem origem no ingês \textit{Latent Autoimune Diabetes in Adults} que significa "Diabetes auto-imune latente em adultos". 
Este tipo de diabetes é considerado uma variação de diabetes tipo 1, embora com uma evolução mais lenta. Por isso mesmo é às vezes referido como diabetes tipo 1.5.~\cite{type15} Muitas vezes este tipo de diabetes é erradamente diagnosticado como diabetes tipo 2: estima-se que entre 15\% e 20\% das pessoas diagnosticadas com diabetes tipo 2 tenham na verdade diabetes LADA.~\cite{type15}
\end{itemize}

O tratamento para qualquer um dos tipos passa por um controlo da glicemia e por um plano de dieta e exercício, em conjunto com a medicação, tal como mencionado no Capítulo 1. A medicação, seja por comprimidos ou por injeção de insulina, também é personalizada para cada doente visto que esta depende do fator de sensibilidade de cada pessoa.
O fator de sensibilidade é quanto uma unidade de insulina consegue baixar a glicemia. Portanto, doses iguais podem ter efeitos diferentes sobre a glicemia em pessoas diferentes, pelo que o tratamento através da insulina é personalizado para cada doente.

Uma das formas que o médico tem para saber se o tratamento do seu paciente está a correr da forma adequada é através da hemoglobina glicada (HbA1c). A hemoglobina é uma proteína existente nos glóbulos vermelhos que se junta com a glicose presente no sangue, tornando-se glicada. A medição da hemoglobina glicada permite saber a média dos valores de glicemia nas últimas semanas ou meses e o seu valor é dado em percentagem. Quanto maior o valor da HbA1c, maior a probabilidade de desenvolver complicações relacionadas com a diabetes.
Para se ter uma ideia do intervalo de valores, geralmente o objetivo de HbA1c para diabéticos é de 6.5\%. Numa pessoa normal o valor é abaixo dos 6\% e um valor entre 6.0\% e 6.4\% indica pré-diabetes.~\cite{hba1c} Pré-diabetes significa que o valor não é alto o suficiente para ser considerado diabetes mas, se não houver intervenção, é provável que a pessoa com pré-diabetes venha a sofrer de diabetes tipo 2 num prazo de 10 anos.~\cite{prediabetes}

Além dos fatores discutidos, existem outros que podem causar alterações nos valores de glicemia, como doenças. Por exemplo, a gripe faz aumentar os valores de glicemia. O exercício também provoca alterações: ao fazer exercício estamos a gastar energia, ou seja, glicose, e portanto naturalmente que os valores de glicemia tendem a baixar depois do exercício. Por outro lado, uma rotina sedentária não usa a glicose em excesso o que leva a um aumento dos níveis de glicemia. Esta oscilação da quantidade de glicose no sangue por vezes atinge extremos, que não são, de todo, desejáveis. Valores muito baixos de glicemia têm o nome de hipoglicemia e valores muito altos chamam-se de hiperglicemia.
Tanto a hipo como a hiperglicemia são estados que podem fazer parte do dia-a-dia dos diabéticos e são ambos perigosos.  A hiperglicemia pode provocar complicações a longo prazo, como doenças renais ou cardíacas. Por outro lado, a hipoglicemia é mais perigosa a curto prazo, pois uma hipoglicemia pode levar a um estado de inconsciência. Isto acontece porque o nosso cérebro precisa de açúcar, e, na falta deste, pode haver perda de consciência ou até mesmo lesões cerebrais e morte. Se o paciente diabético não tiver consciência que está em hipoglicemia, pode desmaiar antes de poder ingerir açúcar e, no caso de estar sozinho, pode levar a uma consequência grave.

Isto vem mais uma vez corroborar aquilo que temos vindo a repetir: o controlo da glicemia é vital. Esta necessidade levou à criação de várias ferramentas que podem ajudar o doente diabético a ter este controlo. De seguida vamos abordar algumas destas ferramentas.


\subsection{Dispositivos para monitorizar a diabetes}

Há vários dispositivos existentes, alguns mais completos que os outros, mas todos com o mesmo objetivo básico: medir a glicemia e colocá-la a valores normais, se necessário. Alguns dispositivos fazem isto de forma automática, como as bombas infusoras de insulina, outros fazem-nos de forma indireta, ao alertar o utilizador para que ele possa fazê-lo. Entres estes últimos incluem-se os monitores contínuos de glicose e os glicosímetros. 
Como já referido anteriormente, os \textit{smartphones} também têm utilidade, ao ter aplicaçes que permitam o registo de valores de glicemia, que, ao contrário do papel, são facilmente acessíveis e podem ser mostrados ao médico na consulta, caso seja preciso. No entanto, a análise a aplicações para ajuda na diabetes será feita apenas no Capítulo 3.

\textbf{Bombas infusoras de insulina}

Uma bomba infusora de insulina é um pequeno dispositivo que liberta insulina de ação rápida 24 horas por dia. A quantidade de insulina libertada é ajustada de acordo com as necessidades do utilizador. Existem várias marcas e modelos no mercado, e, apesar de todas terem o mesmo objetivo fundamental, têm algumas diferenças nas funcionalidades que oferecem. Um exemplo de bomba é a Accu-Chek Combo: é composta pela bomba e por um monitor de glicemia, que comunicam entre si através de \textit{bluetooth} para que a insulina injetada seja de acordo com os níveis de glicemia.~\cite{akku}

\textbf{Glicosímetros}

O glicosímetro é o dispositivo base para qualquer diabético: permite medir os níveis de glicemia a qualquer instante, através de uma pequena quantidade de sangue. São uma importante ferramenta pois permitem ao doente saber qual o seu nível de glicose no sangue a dada altura para que possa assim ajustar a insulina a tomar.

\textbf{Monitor contínuo de glicose}

É um pequeno aparelho que o utilizador usa a toda a hora e que está constantemente a medir os níveis de glicemia. Assim, quando estes valores forem demasiado altos ou baixos, emite um aviso para que o utilizador possa tomar a medida mais adequada. Um exemplo de um dispositivo deste tipo é o da Dexcom.~\cite{cgm}


\section{\textit{Data Mining}}

\textit{Data mining} é uma área de ciência de computadores que permite, através da análise de grandes quantidades de dados, descobrir padrões e regras que uma análise mais simples pode não detetar.~\cite{oracle}
A área de \textit{data mining} usa diversos métodos de outras áreas tais como matemática, inteligência artificial e \textit{machine learning} para tratar, explorar e obter conclusões acerca dos dados. Esta área é utilizada para diversos fins, sendo que alguns são deteção de anomalias, associação e classificação. 

\begin{itemize}

\item{\textbf{deteção de anomalias}} - 
Tem como objetivo a identificação de valores anormais. Esses valores podem ser apenas erros mas também podem ser valores interessantes para uma determinada área. A deteção de anomalias pode ser utilizada para detetar fraude ou invasão de uma rede, por exemplo.

\item{\textbf{associação}} - 
Tem como objetivo encontrar relações entre variáveis e pode quantificar essas relações. Esta tarefa do \textit{data mining} é também chamada de \textit{market basket analysis} uma vez que foi utilizada a primeira vez com o objetivo de negócio. A associação será definida com mais detalhe e com alguns exemplos mais à frente neste capítulo, uma vez que uma parte importante deste trabalho passa por utilizar esta técnica. 

\item{\textbf{classificação}} - 
Tem como objetivo estudar conjuntos de dados e gerar modelos com base nesses dados. Depois, ao observar novos dados com igual formato, vai utilizar o modelo gerado para conseguir classificar corretamente esses dados. Esta categoria pode ser especialmente relevante na saúde. Por exemplo, imaginemos que geramos um modelo de classificação com base num conjunto de dados de pacientes com um tumor na mama, que pode ser maligno ou benigno, e cujo diagnóstico é conhecido. Com esse modelo, será possível prever o diagnóstico em novos dados com uma grande precisão. 


\end{itemize}

A área de \textit{data mining} tem-se tornado cada vez mais popular e mais usada em variadas áreas, como economia, educação e saúde. E é fácil perceber o porquê: por exemplo, num supermercado, o conhecimento dos produtos que são mais comprados, ou de quem compra o quê, pode ser usado para maximizar as vendas, ou seja, maximizar o lucro. Por ser um campo da ciência de computadores que permite aumentar o conhecimento sobre tudo o que nos rodeia, pode ser também utilizada na medicina para obter mais informações sobre algumas doenças, como a diabetes, neste caso.

Para este trabalho vão ser utilizadas algumas ferramentas especialmente úteis na área de \textit{data mining}. Uma dessas ferramentas é a linguagem de programação R. R é uma linguagem usada em computação estatística que permite o uso de variadas técnicas, como criação de modelos lineares e não-lineares, análises temporais e classificação, que é aquilo que nos interessa, entre outras. É também uma ferramenta que permite a criação e visualização de gráficos com bastante facilidade. O uso da linguagem R com as funcionalidades que já traz de raíz é suficiente para uma primeira fase de análises estatísticas mais básicas, pois estas análises serão feitas recorrendo apenas a médias ou gráficos.

No entanto, as funções pré-existentes no R não são suficientes para uma análise mais avançada, como associação, que vai ser utilizada neste trabalho. O objetivo da associação é descobrir regras escondidas nos dados de um grande \textit{data set}, através da relação de variáveis. Embora a associação tenha sido criada com o objetivo de usar em negócios, hoje em dia é utilizada em várias outras áreas, tais como diagnóstico médico ou análise de dados científicos.~\cite{chapter6}
Um exemplo da utilização das regras de associação em negócios é o caso da cadeia de supermercados Walmart que, ao analisar transações passadas, descobriu que nos dias que antecediam um furacão, as compras de lanternas aumentavam bastante, o que faz sentido. No entanto, descobriram um facto curioso: juntamente com as lanternas, as vendas que mais aumentavam eram a de um tipo específico de biscoito de morango. Porquê? Porque este biscoito tinha um grande prazo de validade e não precisava de electricidade ou de outro bem essencial para se consumir. Portanto, sempre que havia previsão de furacões, a cadeia de supermercados enchia as prateleiras com esses biscoitos, que ainda assim esgotavam.~\cite{walmart}
Isto é o que as regras de associação podem oferecer: ao analisar grandes quantidades de dados, pode-se descobrir tendências temporais, por exemplo, ou relações entre produtos, e usar essa informação de maneiras úteis. 

No campo da associação existem alguns algoritmos populares: Apriori, Eclat e FB-Growth. Todos os algoritmos produzem o mesmo resultado final, sendo que as diferenças entre eles prendem-se com o método utilizado e tempos de computação. Nesta dissertação, optámos por usar o algoritmo Apriori, por ser o algoritmo mais importante e conhecido. O algoritmo Apriori vai produzir regras de associação, que são da forma

\begin{align*}
\{X\} \rightarrow Y 
\end{align*}

sendo que $\{X\}$ é um conjunto de uma ou mais variáveis e Y é apenas uma variável. Também se pode chamar antecedente ao lado esquerdo e consequente ao lado direito. Cada regra de associação tem alguns parâmetros a ela associada, nomeadamente a confiança e o suporte.

A confiança é a probabilidade condicional de o consequente ocorrer sabendo que o antecedente ocorre.~\cite{apriori} Por exemplo, uma confiança de 90\% numa regra 

\begin{align*}
\{X, Z\} \rightarrow Y  
\end{align*}

significa que em 90\% das vezes que X e Z ocorrem, Y também ocorre. A confiança é útil para provar a fidedignidade de uma dada regra.

Suporte indica a frequência do antecedente em todo o \textit{data set}. Isto é, se $ \{X, Z\} $ tiver um suporte de 20\%, significa que em 20\% das transações, ocorre $\{X, Z\}$.~\cite{apriori} O suporte serve para garantir que um dado antecedente pertence a um padrão, ao ocorrer frequentemente. Um antecedente com um suporte muito baixo pode não pertencer a um padrão e ser apenas uma ocorrência pontual.

Um outro parâmetro útil para avaliar uma regra é o \textit{lift}. \textit{Lift} é um quociente que permite averiguar a independência de duas ou mais variáveis e é dado pela fórmula 

\begin{align*}
\frac{supp(X\cup Y)}{supp(X)\times supp(Y)}
\end{align*}

que relaciona o suporte das variáveis. Um \textit{lift} igual a 1 significa que a probabilidade de ocorrência do antecedente e a probabilidade de ocorrência do consequente são independentes e, portanto, não é possível gerar regras. Um \textit{lift} acima de 1 indica que há alguma dependência entre as variáveis, sendo que quanto maior for o \textit{lift} maior é a dependência. Este parâmetro é útil para ajudar a medir a utilidade de regras.

Como mencionado, as funções nativas do R não são suficientes para gerar regras de associação. No entanto, uma das características que ajudou a tornar o R tão popular é o facto de esta linguagem ser facilmente expansível, ou seja, adicionar funções que originalmente não existem. Isto é possível através de \textit{packages}.
Um \textit{package} é um conjunto de funções e/ou dados, que pode ser feito por qualquer pessoa e pode ser adicionado ao R.~\cite{packages} Ao adicionar um novo \textit{package} ao R, todas as suas funções passam a ficar disponíveis para utilização, bastando para isso carregar a extensão em cada sessão. Existe uma rede de servidores \textit{web} e ftp que guardam versões atualizadas de código e documentação para o R, chamada CRAN. O CRAN ("Comprehensive R Archive Network") tem atualmente mais de 8000 \textit{packages} disponíveis para \textit{download}, tornando o R altamente personalizável e poderoso.~\cite{cran}
Neste caso em específico em que se pretende usar algoritmos de associação, basta instalar um novo \textit{package} criado propositadamente para esse efeito e passamos a ter uma variedade de funções disponíveis. 

Depois da associação de regras, iremos fazer ainda um outro tipo de análise que envolve \textit{redes} bayesianas. Uma rede \textit{bayesiana} é um modelo que representa variáveis e as suas relações através de um grafo acíclico dirigido, ou seja, um grafo dirigido que não tem ciclos.~\cite{bayes} Não ter ciclos significa que é impossível ter um vértice com um caminho que começa e acaba nesse vértice. Uma rede deste tipo permite, por exemplo, calcular a probabilidade de uma determinada variável ter um determinado valor, tendo em conta as outras variáveis. Por exemplo, se criarmos uma rede \textit{bayesiana} com a variável ``Cancro do Pulmão'' e outras variáveis como ``Fumador'', ``Amianto'' ou ``Arsénio'', é possível calcular a probabilidade de uma pessoa ter cancro do pulmão sabendo que é fumadora ou que esteve continuamente exposta a amianto. Também é possível saber, através de uma rede deste tipo, qual as variáveis com mais influência na variável a classificar. Neste trabalho em concreto, uma rede deste tipo pode ser útil para perceber de que forma os vários parâmetros podem ter influência sobre os valores de glicemia.

Para as análises com redes \textit{bayesianas} serão utilizados dois programas: o Weka e o SamIAm.
O Weka, ou \textit{Waikato Environment for Knowledge Analysis} permite aplicar vários algoritmos de \textit{machine learning} e é possível utilizá-lo para classificação, associação e visualização de dados, entre outros. Embora o WEKA também tenha incorporados algoritmos de associação, nomedamente o \textit{apriori}, não é utilizado com esse intuito uma vez que as funções disponíveis pelo R são suficientes. Neste caso, o WEKA é usado para gerar uma rede \textit{bayesiana} para cada utilizador que vai depois ser analisada por um outro \textit{software}, o SamIAm.

O SamIAm, cuja acrónimo significa \textit{Sensivity Analysis, Modeling, Inference And More}, é uma ferramenta desenhada propositadamente para a modelagem e trabalho com redes \textit{bayesianas}. Com o SamIAm é possível fazer diversas análises mas para este trabalho interessa-nos saber como se relacionam as várias variáveis. Isto é, descobrir quais as variáveis que se relacionam mais com o valor de glicemia, por exemplo, e de que forma é que mudar uma determinada variável muda também a glicemia.

Estas análises serão descritas mais pormenorizadamente no capítulo 5.

\subsection{\textit{Data Mining} na diabetes}

No âmbito desta dissertação, o \textit{data mining} pode ser útil para ajudar a manter os valores da glicose o mais estáveis possível. Por exemplo, ao analisar os registos de um paciente durante um mês dos vários parâmetros, como horas das refeições, quantidade de hidratos de carbono a cada refeição, dose de insulina, exercício e doenças. O mais natural seja que, algures durante o mês, existam valores demasiado altos e valores demasiado baixos. 
No entanto, para o paciente isto pode passar despercebido ou, mesmo que não, o paciente pode achar que os valores são isolados e que não têm nenhuma razão específica, e não lhes dar importância. Pode ser esse o caso, e de facto não haver nenhuma razão específica para um valor mais alto, mas também pode haver, e é aqui que o \textit{data mining} pode dar uma ajuda preciosa:  perceber o porquê de certos valores altos ou baixos existirem. Por exemplo, se um paciente fizer exercício uma vez por semana ao fim do dia, e depois não se alimentar adequadamente, pode ter uma hipoglicemia no dia seguinte. No dia seguinte, ao perceber que está em hipoglicemia, o paciente pode até associar esse valor ao exercício do dia anterior. Mas também é possível que na próxima vez que fizer exercício já não se lembre do que aconteceu, e volte a cometer o mesmo erro. 
Neste caso, ao analisar os registos do paciente durante um mês, seria possível, através da associação, descobrir um padrão: a grande maioria das vezes que o paciente faz exercício é seguida por uma hipoglicemia na manhã seguinte. Basta descobrir este padrão e dá-lo a conhecer ao paciente para que ele se alimente melhor, e acaba-se com alguns valores hiperglicémicos. 

Assim, e imaginando que o paciente utilizaria a aplicação MyDiabetes, uma vez que este padrão fosse aprendido pela aplicação, sempre que o utilizador registasse que iria fazer exercício, ou que já tinha feito, a aplicação mostraria um aviso e aconselharia o paciente a comer mais nessa noite ou a tomar menos insulina. É em casos como estes que aplicar técnicas de \textit{data mining} sobre dados de registos diabéticos pode fornecer uma ajuda importante no controlo da glicemia.\newline

Neste capítulo concluem-se, fundamentalmente, duas coisas: 1) a diabetes, embora sem cura, pode ser controlada e permitir aos doentes levarem uma vida normal, e 2) que a tecnologia, nomeadamente a informática, cada vez mais apresenta ferramentas que possam dar um contributo importante. 

